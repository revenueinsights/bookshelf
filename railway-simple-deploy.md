# Simple Railway Deployment Guide

## Quick Deploy (5 minutes)

### 1. Install Railway CLI
```bash
# Using Homebrew (recommended)
brew install railway

# Or using npm
npm install -g @railway/cli
```

### 2. Login to Railway
```bash
railway login
```

### 3. Deploy Your App
```bash
# Make the deployment script executable
chmod +x deploy-railway.sh

# Run the deployment
./deploy-railway.sh
```

### 4. Set NEXTAUTH_URL (IMPORTANT!)
After deployment:
1. Go to your Railway dashboard
2. Find your app's URL (something like `https://your-app-name.railway.app`)
3. Set the environment variable:
   ```
   NEXTAUTH_URL=https://your-app-name.railway.app
   ```

## Manual Deployment Steps

If the script doesn't work, follow these manual steps:

### 1. Create Railway Project
```bash
railway init
```

### 2. Add PostgreSQL Database
```bash
railway add postgres
```

### 3. Set Environment Variables
```bash
# Generate and set NEXTAUTH_SECRET
railway variables set NEXTAUTH_SECRET="$(node -e "console.log(require('crypto').randomBytes(32).toString('base64'))")"

# Set production environment
railway variables set NODE_ENV="production"

# Generate analytics API key
railway variables set ANALYTICS_CRON_API_KEY="$(node -e "console.log(require('crypto').randomBytes(32).toString('hex'))")"
```

### 4. Deploy
```bash
railway up
```

### 5. Set NEXTAUTH_URL
After deployment, get your app URL and set:
```bash
railway variables set NEXTAUTH_URL="https://your-app-name.railway.app"
```

## Troubleshooting

### Common Issues:

1. **Database Connection Failed**
   - Check if PostgreSQL service is added: `railway services`
   - Verify DATABASE_URL is set: `railway variables`

2. **Build Failed**
   - Check logs: `railway logs`
   - Ensure all dependencies are in package.json

3. **App Won't Start**
   - Check if NEXTAUTH_URL is set correctly
   - Verify all required environment variables are set

4. **Authentication Issues**
   - Make sure NEXTAUTH_SECRET is set
   - Verify NEXTAUTH_URL matches your actual app URL

### Useful Commands:
```bash
railway logs          # View application logs
railway open          # Open your deployed app
railway status        # Check deployment status
railway variables     # View environment variables
railway services      # List all services
```

## Environment Variables Checklist

Required:
- ‚úÖ `DATABASE_URL` (automatically set by Railway PostgreSQL)
- ‚úÖ `NEXTAUTH_SECRET` (generated by script)
- ‚úÖ `NEXTAUTH_URL` (set to your app's URL)
- ‚úÖ `NODE_ENV=production`

Optional:
- `GOOGLE_CLIENT_ID` (for Google OAuth)
- `GOOGLE_CLIENT_SECRET` (for Google OAuth)
- `ANALYTICS_CRON_API_KEY` (for analytics cron jobs)

## Success Indicators

Your deployment is successful when:
1. `railway logs` shows "‚úÖ Database setup successful"
2. `railway logs` shows "üåê Starting the application..."
3. `railway open` opens your working app
4. You can sign up/sign in to your app 